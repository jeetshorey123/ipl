{% extends "base.html" %}

{% block title %}Team Analysis - Cricket Analytics Hub{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h2 class="text-gradient mb-3">
            <i class="fas fa-users me-2"></i>
            Team Analysis
        </h2>
    <p class="text-muted">Comprehensive team performance analysis with clean, textual summaries</p>
    </div>
</div>

<!-- Team Selection -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card modern-card">
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <label for="teamSelect" class="form-label">Select Team</label>
                        <select class="form-select" id="teamSelect">
                            <option value="">Choose a team...</option>
                        </select>
                    </div>
                    <div class="col-md-2 mb-3">
                        <label for="teamFormatFilter" class="form-label">Format</label>
                        <select class="form-select" id="teamFormatFilter">
                            <option value="">All Formats</option>
                            <option value="Test">Test</option>
                            <option value="ODI">ODI</option>
                            <option value="T20">T20</option>
                        </select>
                    </div>
                    <div class="col-md-2 mb-3">
                        <label for="teamInningsTypeFilter" class="form-label">Innings Type</label>
                        <select class="form-select" id="teamInningsTypeFilter">
                            <option value="">Overall</option>
                            <option value="first">Batting First</option>
                            <option value="second">Chasing</option>
                        </select>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label for="opponentFilter" class="form-label">Opponents</label>
                        <select class="form-select" id="opponentFilter" multiple>
                            <!-- Populated dynamically with all teams -->
                        </select>
                        <small class="text-muted">Hold Ctrl/Cmd to select multiple</small>
                    </div>
                    <div class="col-md-2 mb-3">
                        <label for="teamMatchCategoryFilter" class="form-label">Competition</label>
                        <select class="form-select" id="teamMatchCategoryFilter">
                            <option value="">All Matches</option>
                            <option value="international">International</option>
                            <option value="ipl">IPL</option>
                        </select>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label for="teamVenueFilter" class="form-label">Venue</label>
                        <select class="form-select" id="teamVenueFilter">
                            <option value="">All Venues</option>
                        </select>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label for="teamCountryFilter" class="form-label">Country/City</label>
                        <select class="form-select" id="teamCountryFilter">
                            <option value="">All Countries</option>
                        </select>
                    </div>
                    <div class="col-md-2 mb-3">
                        <label for="teamYearsFilter" class="form-label">Years</label>
                        <select multiple class="form-select" id="teamYearsFilter"></select>
                        <small class="text-muted">Hold Ctrl/Cmd to select multiple</small>
                    </div>
                    <div class="col-md-2 mb-3">
                        <label class="form-label">&nbsp;</label>
                        <button class="btn btn-primary w-100" id="analyzeTeamBtn">
                            <i class="fas fa-chart-line me-2"></i>Analyze
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Team Stats Display -->
<div id="teamStatsContainer" style="display: none;">
    <!-- Team Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card modern-card">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h3 class="mb-1" id="teamName">Team Name</h3>
                            <p class="text-muted mb-0" id="teamSummary">Performance Summary</p>
                        </div>
                        <div class="col-md-4 text-md-end">
                            <button class="btn btn-outline-primary" id="compareTeamBtn">
                                <i class="fas fa-balance-scale me-2"></i>Compare Teams
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Team Performance Cards -->
    <div class="row mb-4">
        <div class="col-md-2 mb-3">
            <div class="stats-card">
                <div class="card-body text-center">
                    <div class="stats-icon">
                        <i class="fas fa-calendar text-primary"></i>
                    </div>
                    <h4 class="stats-number" id="teamTotalMatches">-</h4>
                    <p class="stats-label">Matches</p>
                </div>
            </div>
        </div>
        <div class="col-md-2 mb-3">
            <div class="stats-card">
                <div class="card-body text-center">
                    <div class="stats-icon">
                        <i class="fas fa-trophy text-success"></i>
                    </div>
                    <h4 class="stats-number" id="teamWins">-</h4>
                    <p class="stats-label">Wins</p>
                </div>
            </div>
        </div>
        <div class="col-md-2 mb-3">
            <div class="stats-card">
                <div class="card-body text-center">
                    <div class="stats-icon">
                        <i class="fas fa-times text-danger"></i>
                    </div>
                    <h4 class="stats-number" id="teamLosses">-</h4>
                    <p class="stats-label">Losses</p>
                </div>
            </div>
        </div>
        <div class="col-md-2 mb-3">
            <div class="stats-card">
                <div class="card-body text-center">
                    <div class="stats-icon">
                        <i class="fas fa-percentage text-warning"></i>
                    </div>
                    <h4 class="stats-number" id="teamWinPercentage">-</h4>
                    <p class="stats-label">Win %</p>
                </div>
            </div>
        </div>
        <div class="col-md-2 mb-3">
            <div class="stats-card">
                <div class="card-body text-center">
                    <div class="stats-icon">
                        <i class="fas fa-coins text-info"></i>
                    </div>
                    <h4 class="stats-number" id="teamTossWins">-</h4>
                    <p class="stats-label">Toss Wins</p>
                </div>
            </div>
        </div>
        <div class="col-md-2 mb-3">
            <div class="stats-card">
                <div class="card-body text-center">
                    <div class="stats-icon">
                        <i class="fas fa-chart-line text-secondary"></i>
                    </div>
                    <h4 class="stats-number" id="teamRecentForm">-</h4>
                    <p class="stats-label">Recent Form</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Detailed Team Analysis -->
    <div class="row">
        <div class="col-12">
            <div class="card modern-card">
                <div class="card-header bg-transparent">
                    <ul class="nav nav-tabs card-header-tabs" id="teamStatsTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">
                                <i class="fas fa-chart-bar me-2"></i>Overview
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="performance-tab" data-bs-toggle="tab" data-bs-target="#performance" type="button" role="tab">
                                <i class="fas fa-tachometer-alt me-2"></i>Performance
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="phase-tab" data-bs-toggle="tab" data-bs-target="#phase" type="button" role="tab">
                                <i class="fas fa-layer-group me-2"></i>Phase Averages
                            </button>
                        </li>
                    </ul>
                </div>
                <div class="card-body">
                    <div class="tab-content" id="teamStatsTabContent">
                        <!-- Overview Tab -->
                        <div class="tab-pane fade show active" id="overview" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    <h6 class="text-primary mb-3">Batting First vs Bowling First</h6>
                                    <div class="row" id="battingBowlingFirst">
                                        <!-- Will be populated with data -->
                                    </div>
                                </div>
                                <div class="col-md-6 mb-4">
                                    <h6 class="text-primary mb-3">Format Performance</h6>
                                    <div id="formatPerformance" class="analysis-text"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Performance Tab -->
                        <div class="tab-pane fade" id="performance" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    <h6 class="text-primary mb-2">Win Margin Distribution</h6>
                                    <div id="winMarginText" class="analysis-text"></div>
                                </div>
                                <div class="col-md-6 mb-4">
                                    <h6 class="text-primary mb-2">Performance by Format</h6>
                                    <div id="formatText" class="analysis-text"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Phase Averages Tab -->
                        <div class="tab-pane fade" id="phase" role="tabpanel">
                            <div class="row">
                                <div class="col-12">
                                    <p class="text-muted">Phase-wise team averages. For T20/T20I: Powerplay (1-6), Middle (7-15), Death (16-20). For ODI: Phase 1 (1-10), Phase 2 (11-35), Phase 3 (36-50).</p>
                                </div>
                                <div class="col-md-6">
                                    <div class="phase-card mb-3">
                                        <div class="phase-header"><h6>T20/T20I Phases</h6></div>
                                        <div class="phase-stats" id="t20PhaseAverages"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="phase-card mb-3">
                                        <div class="phase-header"><h6>ODI Phases</h6></div>
                                        <div class="phase-stats" id="odiPhaseAverages"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Team Comparison Modal -->
<div class="modal fade" id="compareTeamsModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-balance-scale me-2"></i>Team Comparison
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-3">
                    <div class="col-md-4">
                        <label for="compareTeam1" class="form-label">Team 1</label>
                        <select class="form-select" id="compareTeam1">
                            <option value="">Select Team 1...</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label for="compareTeam2" class="form-label">Team 2</label>
                        <select class="form-select" id="compareTeam2">
                            <option value="">Select Team 2...</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">&nbsp;</label>
                        <button class="btn btn-primary w-100" id="startTeamComparisonBtn">
                            <i class="fas fa-chart-bar me-2"></i>Compare
                        </button>
                    </div>
                </div>
                <div id="teamComparisonResults">
                    <!-- Team comparison results will be displayed here -->
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
// Team Analysis JavaScript
let currentTeamData = null;
let teamsData = [];

document.addEventListener('DOMContentLoaded', function() {
    initializeTeamsPage();
});

async function initializeTeamsPage() {
    try {
        await Promise.all([
            loadTeamsData(),
            loadVenuesForTeams(),
            loadCountriesForTeams(),
            loadYearsForTeams()
        ]);
        setupTeamEventListeners();
    } catch (error) {
        console.error('Error initializing teams page:', error);
        CricketAnalytics.showAlert('Error loading data. Please refresh the page.', 'danger');
    }
}

async function loadTeamsData() {
    try {
        const response = await axios.get('/api/all-teams');
        teamsData = response.data.teams.sort();
        
        const selects = ['teamSelect', 'opponentFilter', 'compareTeam1', 'compareTeam2'];
        
        selects.forEach(selectId => {
            const select = document.getElementById(selectId);
            if (select) {
                teamsData.forEach(team => {
                    const option = document.createElement('option');
                    option.value = team;
                    option.textContent = team;
                    select.appendChild(option);
                });
            }
        });
    } catch (error) {
        console.error('Error loading teams:', error);
        throw error;
    }
}

async function loadVenuesForTeams() {
    try {
        const response = await axios.get('/api/all-venues');
        const venues = response.data.venues.sort();
        
        const venueSelect = document.getElementById('teamVenueFilter');
        if (venueSelect) {
            venues.forEach(venue => {
                const option = document.createElement('option');
                option.value = venue;
                option.textContent = venue;
                venueSelect.appendChild(option);
            });
        }
    } catch (error) {
        console.error('Error loading venues:', error);
        throw error;
    }
}

async function loadCountriesForTeams() {
    try {
        const response = await axios.get('/api/all-countries');
        const countries = (response.data.countries || []).sort();
        const select = document.getElementById('teamCountryFilter');
        if (select) {
            countries.forEach(c => {
                const option = document.createElement('option');
                option.value = c;
                option.textContent = c;
                select.appendChild(option);
            });
        }
    } catch (error) {
        console.error('Error loading countries:', error);
        throw error;
    }
}

async function loadYearsForTeams() {
    try {
        const response = await axios.get('/api/data/years');
        const years = response.data.years || [];
        const select = document.getElementById('teamYearsFilter');
        if (select) {
            years.forEach(y => {
                const option = document.createElement('option');
                option.value = y;
                option.textContent = y;
                select.appendChild(option);
            });
        }
    } catch (error) {
        console.error('Error loading years:', error);
        throw error;
    }
}

function setupTeamEventListeners() {
    document.getElementById('analyzeTeamBtn').addEventListener('click', analyzeTeam);
    document.getElementById('compareTeamBtn').addEventListener('click', function() {
        const modal = new bootstrap.Modal(document.getElementById('compareTeamsModal'));
        modal.show();
    });
    document.getElementById('startTeamComparisonBtn').addEventListener('click', compareSelectedTeams);
}

async function analyzeTeam() {
    const team = document.getElementById('teamSelect').value;
    
    if (!team) {
        CricketAnalytics.showAlert('Please select a team to analyze.', 'warning');
        return;
    }
    
    try {
        CricketAnalytics.showLoading();
        
        const params = new URLSearchParams();
    const format = document.getElementById('teamFormatFilter').value;
        const venue = document.getElementById('teamVenueFilter').value;
        const matchCategory = document.getElementById('teamMatchCategoryFilter').value;
        const inningsType = document.getElementById('teamInningsTypeFilter').value;
    // Batting order filter removed as per requirements
        const country = document.getElementById('teamCountryFilter').value;
        const yearsSelect = document.getElementById('teamYearsFilter');
        const years = Array.from(yearsSelect.selectedOptions).map(o => o.value);
    const opponentsSelect = document.getElementById('opponentFilter');
    const opponents = opponentsSelect ? Array.from(opponentsSelect.selectedOptions).map(o => o.value) : [];
        
        if (format) params.append('format', format);
        if (venue) params.append('venue', venue);
        if (matchCategory) params.append('match_category', matchCategory);
        if (inningsType) params.append('innings_type', inningsType);
        if (country) params.append('country', country);
        if (years.length) params.append('years', JSON.stringify(years));
    if (opponents.length) params.append('opponents', JSON.stringify(opponents));
        
        const response = await axios.get(`/api/team-stats/${encodeURIComponent(team)}?${params}`);
        
        currentTeamData = response.data;
        displayTeamStats();
        CricketAnalytics.hideLoading();
        
    } catch (error) {
        console.error('Error analyzing team:', error);
        CricketAnalytics.showAlert('Error analyzing team data. Please try again.', 'danger');
        CricketAnalytics.hideLoading();
    }
}

function displayTeamStats() {
    if (!currentTeamData || currentTeamData.error) {
        CricketAnalytics.showAlert('No data available for the selected team.', 'warning');
        return;
    }
    
    const stats = currentTeamData;
    const general = stats.general || {};
    
    document.getElementById('teamStatsContainer').style.display = 'block';
    
    // Update header
    document.getElementById('teamName').textContent = stats.team_name;
    const oppSel = document.getElementById('opponentFilter');
    const opps = oppSel ? Array.from(oppSel.selectedOptions).map(o => o.value) : [];
    const oppText = opps.length ? ` vs ${opps.join(', ')}` : '';
    document.getElementById('teamSummary').textContent = `${general.total_matches} matches analyzed${oppText} with current filters`;
    
    // Update performance cards
    document.getElementById('teamTotalMatches').textContent = general.total_matches || 0;
    document.getElementById('teamWins').textContent = general.wins || 0;
    document.getElementById('teamLosses').textContent = general.losses || 0;
    document.getElementById('teamWinPercentage').textContent = `${general.win_percentage || 0}%`;
    document.getElementById('teamTossWins').textContent = general.toss_wins || 0;
    
    // Recent form
    const recentForm = stats.performance?.recent_form?.win_percentage || 0;
    document.getElementById('teamRecentForm').textContent = `${recentForm}%`;
    
    // Update overview tab
    updateOverviewTab(general);
    // Update textual performance tab
    updatePerformanceText(stats.performance);
    // Update phase averages
    renderPhaseAverages(stats.phase_averages);
    
    // Scroll to stats
    document.getElementById('teamStatsContainer').scrollIntoView({ behavior: 'smooth' });
}

function updateOverviewTab(general) {
    // Batting first vs bowling first
    const battingBowlingDiv = document.getElementById('battingBowlingFirst');
    const battingFirst = general.batting_first || {};
    const bowlingFirst = general.bowling_first || {};
    
    battingBowlingDiv.innerHTML = `
        <div class="col-6">
            <div class="card bg-primary text-white">
                <div class="card-body text-center">
                    <h6>Batting First</h6>
                    <p class="mb-1"><strong>Matches:</strong> ${battingFirst.matches || 0}</p>
                    <p class="mb-1"><strong>Wins:</strong> ${battingFirst.wins || 0}</p>
                    <p class="mb-0"><strong>Win %:</strong> ${battingFirst.win_percentage || 0}%</p>
                </div>
            </div>
        </div>
        <div class="col-6">
            <div class="card bg-success text-white">
                <div class="card-body text-center">
                    <h6>Bowling First</h6>
                    <p class="mb-1"><strong>Matches:</strong> ${bowlingFirst.matches || 0}</p>
                    <p class="mb-1"><strong>Wins:</strong> ${bowlingFirst.wins || 0}</p>
                    <p class="mb-0"><strong>Win %:</strong> ${bowlingFirst.win_percentage || 0}%</p>
                </div>
            </div>
        </div>
    `;
    
    // Format performance
    const formatDiv = document.getElementById('formatPerformance');
    const formatPerf = general.format_performance || {};
    if (Object.keys(formatPerf).length > 0) {
        const items = Object.entries(formatPerf).map(([fmt, s]) => {
            const winPct = s.win_percentage || 0;
            return `<div class="analysis-item"><span class="analysis-label">${fmt} Wins</span><span class="analysis-value">${s.wins || 0}/${s.matches || 0} (${winPct}%)</span></div>`;
        }).join('');
        formatDiv.innerHTML = items;
    } else {
        formatDiv.innerHTML = '<p class="text-muted">No format data available.</p>';
    }
}

function updatePerformanceText(perf) {
    const winDiv = document.getElementById('winMarginText');
    const fmtDiv = document.getElementById('formatText');
    if (!perf) {
        winDiv.innerHTML = '<p class="text-muted">No data.</p>';
        fmtDiv.innerHTML = '<p class="text-muted">No data.</p>';
        return;
    }
    const margins = perf.win_margins || {};
    const byRuns = margins.by_runs || {};
    const byWkts = margins.by_wickets || {};
    winDiv.innerHTML = `
        <div class="analysis-item"><span class="analysis-label">Wins by runs</span><span class="analysis-value">${byRuns.count || 0} matches, avg ${byRuns.average || 0}, max ${byRuns.highest || 0}</span></div>
        <div class="analysis-item"><span class="analysis-label">Wins by wickets</span><span class="analysis-value">${byWkts.count || 0} matches, avg ${byWkts.average || 0}, max ${byWkts.highest || 0}</span></div>
    `;
    const recent = perf.recent_form || {};
    fmtDiv.innerHTML = `
        <div class="analysis-item"><span class="analysis-label">Recent form</span><span class="analysis-value">${recent.wins || 0}/${recent.matches || 0} (${recent.win_percentage || 0}%)</span></div>
    `;
}

function renderPhaseAverages(phase) {
    const t20Div = document.getElementById('t20PhaseAverages');
    const odiDiv = document.getElementById('odiPhaseAverages');
    if (!phase) {
        t20Div.innerHTML = '<p class="text-muted">No T20 phase data.</p>';
        odiDiv.innerHTML = '<p class="text-muted">No ODI phase data.</p>';
        return;
    }
    const render = (obj) => {
        if (!obj) return '<p class="text-muted">No data.</p>';
        const rows = [];
        for (const [name, s] of Object.entries(obj)) {
            rows.push(`<div class="analysis-item"><span class="analysis-label">${name} - Avg Score</span><span class="analysis-value">${s.avg_score ?? '-'}</span></div>`);
            rows.push(`<div class="analysis-item"><span class="analysis-label">${name} - Avg Wickets Taken</span><span class="analysis-value">${s.avg_wkts_taken ?? '-'}</span></div>`);
            rows.push(`<div class="analysis-item"><span class="analysis-label">${name} - Avg Wickets Given</span><span class="analysis-value">${s.avg_wkts_given ?? '-'}</span></div>`);
        }
        return rows.join('');
    };
    t20Div.innerHTML = render(phase.t20);
    odiDiv.innerHTML = render(phase.odi);
}

async function compareSelectedTeams() {
    const team1 = document.getElementById('compareTeam1').value;
    const team2 = document.getElementById('compareTeam2').value;
    
    if (!team1 || !team2) {
        CricketAnalytics.showAlert('Please select both teams for comparison.', 'warning');
        return;
    }
    
    if (team1 === team2) {
        CricketAnalytics.showAlert('Please select different teams for comparison.', 'warning');
        return;
    }
    
    try {
        CricketAnalytics.showLoading();
        
        const params = new URLSearchParams();
        params.append('teams', team1);
        params.append('teams', team2);
        
        const response = await axios.get(`/api/team-comparison?${params}`);
        
        displayTeamComparison(response.data, team1, team2);
        CricketAnalytics.hideLoading();
        
    } catch (error) {
        console.error('Error comparing teams:', error);
        CricketAnalytics.showAlert('Error comparing teams. Please try again.', 'danger');
        CricketAnalytics.hideLoading();
    }
}

function displayTeamComparison(comparisonData, team1, team2) {
    const resultsDiv = document.getElementById('teamComparisonResults');
    
    const stats1 = comparisonData[team1];
    const stats2 = comparisonData[team2];
    const h2h = comparisonData.head_to_head;
    
    if (stats1.error || stats2.error) {
        resultsDiv.innerHTML = `
            <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle me-2"></i>
                Error loading comparison data. Please try different teams.
            </div>
        `;
        return;
    }
    
    let h2hHtml = '';
    if (h2h && !h2h.error) {
        h2hHtml = `
            <div class="col-12 mb-4">
                <div class="card bg-light">
                    <div class="card-header">
                        <h6 class="mb-0">Head-to-Head Record</h6>
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-4">
                                <h5 class="text-primary">${h2h[team1]?.wins || 0}</h5>
                                <p class="mb-0">${team1} Wins</p>
                            </div>
                            <div class="col-4">
                                <h5 class="text-muted">${h2h.total_matches || 0}</h5>
                                <p class="mb-0">Total Matches</p>
                            </div>
                            <div class="col-4">
                                <h5 class="text-success">${h2h[team2]?.wins || 0}</h5>
                                <p class="mb-0">${team2} Wins</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }
    
    const general1 = stats1.general || {};
    const general2 = stats2.general || {};
    
    resultsDiv.innerHTML = `
        <div class="row">
            ${h2hHtml}
            <div class="col-md-6">
                <div class="card border-primary">
                    <div class="card-header bg-primary text-white">
                        <h6 class="mb-0">${team1}</h6>
                    </div>
                    <div class="card-body">
                        <p class="mb-1">Matches: <strong>${general1.total_matches || 0}</strong></p>
                        <p class="mb-1">Wins: <strong>${general1.wins || 0}</strong></p>
                        <p class="mb-1">Win %: <strong>${general1.win_percentage || 0}%</strong></p>
                        <p class="mb-0">Toss Win %: <strong>${general1.toss_win_percentage || 0}%</strong></p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card border-success">
                    <div class="card-header bg-success text-white">
                        <h6 class="mb-0">${team2}</h6>
                    </div>
                    <div class="card-body">
                        <p class="mb-1">Matches: <strong>${general2.total_matches || 0}</strong></p>
                        <p class="mb-1">Wins: <strong>${general2.wins || 0}</strong></p>
                        <p class="mb-1">Win %: <strong>${general2.win_percentage || 0}%</strong></p>
                        <p class="mb-0">Toss Win %: <strong>${general2.toss_win_percentage || 0}%</strong></p>
                    </div>
                </div>
            </div>
        </div>
    `;
}
</script>
{% endblock %}